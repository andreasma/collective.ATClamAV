[buildout]
extends =
  http://dist.plone.org/release/4.0.1/versions.cfg

extensions = mr.developer buildout.dumppickedversions
    
find-links =
  http://dist.plone.org/release/4.0.1
  http://dist.plone.org/thirdparty/
  http://download.zope.org/ppix/
  http://download.zope.org/distribution/
  http://effbot.org/downloads

parts = 
  instance
  test
  zopepy
  hudson
  coverage
  report

versions = versions
develop = .

[versions]


[instance]
recipe = plone.recipe.zope2instance
user = admin:admin
http-address = 8080
debug-mode = on
verbose-security = on

eggs = Plone
  PIL
  collective.ATClamAV

[zopepy]
recipe = zc.recipe.egg
eggs = ${instance:eggs}
interpreter = zopepy
scripts = zopepy

[test]
recipe = zc.recipe.testrunner
eggs =
  Plone
  collective.ATClamAV
defaults = ['--exit-with-status', '--auto-color', '--auto-progress','-s', 'collective.ATClamAV']

[hudson]
recipe = collective.xmltestreport
defaults = ['-x','-q','-s', 'collective.ATClamAV']
eggs = ${instance:eggs}

[coverage]
recipe = zc.recipe.egg
eggs = coverage
initialization =
    sys.argv = sys.argv[:] + ['run', 'bin/hudson', '--all', '-k', '--xml']

[report]
recipe = zc.recipe.egg
eggs = coverage
scripts = coverage=report
initialization =
    eggs = '${buildout:eggs-directory}'
    bin = '${buildout:directory}/bin'
    tests = '${buildout:directory}/src/collective/ATClamAV/tests'
    exclude = '--omit=' + ','.join([eggs, sys.prefix, bin, tests])
    sys.argv = sys.argv[:] + ['xml', '-i', exclude]